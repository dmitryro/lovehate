{% load static %}
{% load gui_extras %}
{% load forum_extras %}
{% load blog_extras %}
{% load meta_extras %}
{% load bootstrap_pagination %}
{% load bootstrap3 %}
<!DOCTYPE html>
<html lang="ru">
<head>
<link rel="apple-touch-icon" sizes="57x57" href="/media/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/media/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/media/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/media/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/media/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/media/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/media/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/media/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/media/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/media/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/media/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/media/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/media/favicon-16x16.png">
<link rel="manifest" href="/media/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<meta http-equiv="content-type" content="text/html;charset=utf-8" />
<meta http-equiv="content-language" content="ru">
<!--
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=yes, maximum-scale=1, user-scalable=yes">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/jquery.validation/1.15.1/jquery.validate.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<script src="/static/js/vendor/jquery.ui.widget.js"></script>
<script src="/static/js/jquery.iframe-transport.js"></script>
<script src="/static/js/jquery.fileupload.js"></script>

<!-- The Load Image plugin is included for the preview images and image resizing functionality -->
<script src="https://blueimp.github.io/JavaScript-Load-Image/js/load-image.all.min.js"></script>
<!-- The Canvas to Blob plugin is included for image resizing functionality -->
<script src="https://blueimp.github.io/JavaScript-Canvas-to-Blob/js/canvas-to-blob.min.js"></script>
<!-- The Iframe Transport is required for browsers without support for XHR file uploads -->
<script src="/static/js/jquery.iframe-transport.js"></script>
<!-- The basic File Upload plugin -->
<!-- The File Upload processing plugin -->
<script src="/static/js/jquery.fileupload-process.js"></script>
<!-- The File Upload image preview & resize plugin -->
<script src="/static/js/jquery.fileupload-image.js"></script>
<link rel="stylesheet" href="https://blueimp.github.io/Gallery/css/blueimp-gallery.min.css">
<!-- CSS to style the file input field as button and adjust the Bootstrap progress bars -->
<link rel="stylesheet" href="/static/css/jquery.fileupload.css">
<link rel="stylesheet" href="/static/css/jquery.fileupload-ui.css">
<!-- CSS adjustments for browsers with JavaScript disabled -->
<noscript><link rel="stylesheet" href="/static/css/jquery.fileupload-noscript.css"></noscript>
<noscript><link rel="stylesheet" href="/static/css/jquery.fileupload-ui-noscript.css"></noscript>
<style>
@import url("https://fonts.googleapis.com/css?family=Open+Sans");
</style>
<link rel="stylesheet" href="/static/css/main-styles.css"/>

</head>
<body>
    <div class="header-pan">
         <div class="container-fluid">

              <div class="row header-pan-top header-row">
                               <div class="col-sm-3">
                                      <div class="container-fluid">
                                            <div class="row">

                                                             <div class="logo-love">
                                                                     Любовь
                                                             </div>
                                                             <div class="logo-and">
                                                                 и
                                                             </div>
                                                             <div class="logo-hate">
                                                              Ненависть
                                                             </div>
                                                             <div class="logo-age">
                                                                  (18+)
                                                             </div>
                                                             <div class="clear"></div>   

                                            </div> <!-- end row -->
                                            <div class="row">
                                                    <div class="header-pan-menu">


                                                    </div>
                                            </div>
                                      </div> <!-- end container -->
                                </div>  <!-- header left ends -->

                                <div class="col-sm-6">&nbsp;</div>
                                <div class="col-sm-3" style="float:right;margin-top:-1.4em;margin-right:0.1em;margin-bottom:-1.6em;">  


                                      <div class="container-fluid">

                                             <form class="search" action="/search" id="searchform" name="searchform" method="GET">
                       <!-- We'll have a button that'll make the search input appear, a submit button and the input -->


                                            <div class="row">
                                              <div class="col-sm-9">

                                                        <input type="text" id="search"  placeholder="Введите текст..." name="q" maxlength="16" size="16">
                                              </div>

                                              <div class="col-sm-3">
                                                  <div style="text-align:center;margin-left:-1.2em;" class="search">
                                                  <button type="submit" style="min-width:6.0em;background:#4a4a4a;"> Искать </button>
                                              </div>

                                              </div>       

                                             </form>
                                    </div>
    
                                 </div>

                                </div>  
                                <div class="clear"></div>


               </div> <!-- row ends -->
               <div class = "row header-pan-middle header-row">
                         <form method="POST" id="menu-form" name="menu-form">
                         <div class="col-sm-4">&nbsp;</div>
                         <div class="col-sm-5" style="margin-left:-1.1em;min-width:41.00em;">
                                  <div id="submenu-div-1" class="menu-item active">
                                          <a id="submenu-1" href="/">Главная</a>
                                  </div>
                                  <div id="submenu-div-2" class="menu-item">
                                       <a id="submenu-2" href="/forum">Форум</a>
                                  </div>
                                  <div id="submenu-div-3" class="menu-item"> 
                                       <a id="submenu-3" href="/blog">Дневник</a>
                                  </div>
                              {% if user.is_authenticated %}
                                  <div id="submenu-div-4" class="menu-item">
                                       <a id="submenu-4" href="/mylh/">Мой ЛХ</a>
                                  </div>
                                  <div id="submenu-div-5" class="menu-item"> 
                                       <a id="submenu-5" href="/private">Приваты</a>
                                  </div>
                              {% endif %}
                                  <div id="submenu-div-6" class="menu-item">
                                       <a id="submenu-6" href="/statistics">Статистика</a>
                                  </div>
                                  <div class="clear"></div>
                         </div>
                         <div class="col-sm-3">


                         </div>
                         <input type="hidden" value="{{ user.username }}" id="session_username" />
                         <input type="hidden" value="{{ current_page }}" id="current_page" />
                         <input type="hidden" value="{{ is_reset_required }}" id="is_reset_required" />
                         <input type="hidden" value="{{ is_reset_possible }}" id="is_reset_possible" />
                         <input type="hidden" value="{{ user_id }}" id="reset_user_id" />
                         </form>

               </div>   
               <div class = "row header-pan-bottom header-row">
                  <div class="col-sm-4"></div>
                  <div class="col-sm-5">
                                 <div id="submenu-main">
                                   <div id="runner-index" style="display:none;">

                                   </div>
                                   <div id="runner" class="runner typewriter">
                                       
                                   </div> 
                                 </div>

                                 <div id="submenu-forum">
                                     <div class="submenu-item">
                                          <a href="/forum">

Новые сообщения
                                          </a>
                                     </div>
                                     <div class="submenu-item">
                                          <a href="/add/">

Создать новую тему 
                                          </a>
                                     </div>                                     
                                     <div class="submenu-item">
                                          <a href="#">

События

                                          </a>
                                     </div>
                                 </div>
                                 <div id="submenu-blog">

                                     <div class="submenu-item">
                                            <a href="/blog">Общий дневник</a>
                                     </div>
                            {% if user.is_authenticated %}
                                     <div class="submenu-item">
                                            <a href="/blog/user/{{ user.id }}">
                                            Ваш дневник
                                            </a>
                                     </div>
                           {% endif %}

                                     <div class="submenu-item">
                                            <a href="/blog/new">
Добавить запись в дневник
                                            </a>
                                     </div>

                                     <div class="submenu-item">
                                         <a href="/rss">
                                     RSS Фид
                                         </a>
                                     </div>
                                     <div class="clear"></div>

                                 </div>
                                 <div id="submenu-mylh">
                                     <div class="submenu-item">
                                            <a href="/mylh/">Профиль</a>
                                     </div>
                                     <div class="submenu-item">
                                            <a href="/settings/{{ user.id }}/">Нaстройки</a>
                                     </div>

                                     <div class="submenu-item">
                                            <a href="/relationships/{{ user.id }}/">
Друзья / Враги
</a>
                                     </div>

                                 </div> 
                                 <div id="submenu-statistics">

                                     <div class="submenu-item">
                                            <a href="#">
                                                   Общая статистика
                                            </a>
                                     </div>
                                     <div class="submenu-item">
                                            <a href="#">
                                                  Ваша статистика 
                                            </a>
                                     </div>



                                 </div>
                                 <div id="submenu-private-messages">

                                 {% if user.is_authenticated %} 
                                     <div class="submenu-item">
                                            <a href="/incoming">Входящие</a>
                                     </div>
                                     <div class="submenu-item">
                                            <a href="/outgoing">Исходящие</a>
                                     </div>
                                     <div class="submenu-item">
                                            <a href="/private">Отправить</a>
                                     </div>
                                     <div class="submenu-item">
                                            <a href="/private/contacts">Контакты</a>
                                     </div>

                                     <div class="submenu-item">
                                            <a href="/private/settings">Нaстройки</a>
                                     </div>

                                     <div class="clear"></div>
                                 {% endif %}
                                 </div>

                  </div>
                  <div class="col-sm-3">
                           <div id="logged-out" class="logged-out">
                                            <form method="POST">
                                               {% if not user.is_authenticated %}
                                                   <a id="modal-login-open" href="#">Зайти</a> 
                                               {% endif %}
                                               {% if user.is_authenticated %}
                                                   <input type="hidden" id="user_id" name="user_id" value="{{ user.id }}" />
                                                   <input type="hidden" id="session_user_name" name="session_user_name" value="{{ username }}" />
                                                   <span style="font-size:0.9em;">{{ username }}</span>  | 
                                                            <a href="/incoming">
                                                                  <span style="font-size:0.88em;">
Приваты

                                                                   </span>
                                                                   {% if has_private %}
                                                                       <span class="red" style="font-size:0.88em;font-weight:bold; ">
(<span style="font-size:0.88em;color:#ff0000;font-weight:bold;">{% incoming_meta user.id %}</span>)
                                                                       </span>
                                                                   {% endif %}
                                                            </a> | <span style="font-size:0.88em;"><a id="session-exit" href="/signout">Выйти</a></span>
                                               {% endif %}
                                            </form>
                           </div>
                           <div class="clear"></div>


                    </div>
               </div>          
              
    </div>
</div>
  
               {% if is_activated %}
                          <div class="success" id="activation-success">
                                        Ваша запись успешно активирована.

                          </div>

               {% endif %}

               {% if resend_activation %}

                     <div class="activation-errors" id="resend-activation-errors" style="display:block;"><span>Ваша ссылка активации более не действительна.</span> </div>

               {% endif %}
               <div class="modal-login modaldialogue" id="modal-send-activation">
                         <div class="modal-header">
                             <div class="container-fluid">
                                <div class="row">
                                     <div class="col-sm-10">
                                      <label><b>
                                      <span>Учётная запись не активирована</span>
                                      </b></label>
                                     </div>
                                     <div class="col-sm-2" id="modal-send-activation-close"><div style="float:right;">x</div><div class="clear"></div></div>
                                </div>
                             </div>

                    </div>
                    <div style="height:1.4em;text-align:center; font-weight:0.8em;">
                          <div class="activation-errors" id="resend-activation-errors"><span>Ошибка. Попытайтесь ещё раз.</span> </div>
                          <div class="success resend-success" id="resend-activation-success">
                                         Ссылка для активации выслана.
                          </div>

                    </div>
                    <div class="modal-body">
                          <form id="resend-activation-form" enctype="multipart/form-data" method="POST">
                              {% csrf_token %}
                              <div class="container-fluid">
                                                      <br/><br/>
                                                        <button id="user-resend-activation" style="background:#4a4a4a;" type="button">

                                                       Переслать Ссылку
                                                       </button>
                                                        <p>
                                                              <a href="#" id="send-reset-link-modal-open-activate">
                                                                    Забыли пароль?
                                                              </a>
                                                        </p>                              

                                                        <p>
                                                               <a id="modal-activation-register-open"
                                                                        href="/register" style="color:dodgerblue">Зарегистрироваться
                                                               </a>
                                                        </p>


                              </div>
                         </form>
                    </div>
               </div>

               <div class="modal-login modaldialogue"  id="send-reset-link-modal">

                         <div class="modal-header">
                             <div class="container-fluid">
                                <div class="row">
                                     <div class="col-sm-10">
                                      <label><b>
                                      <span>
Восстановить Пароль
                                      </span>
                                      </b></label>
                                     </div>
                                     <div class="col-sm-2" id="send-reset-link-modal-close"><div style="float:right;">x</div><div class="clear"></div></div>
                                </div>
                             </div>
                        </div>
                          <form id="recover-password" enctype="multipart/form-data" method="POST">
                              {% csrf_token %}


                          <div class="modal-body">
                               <div class="container-fluid">
                                                        <div class="row">
                                                         <div class="col-sm-12">

                                                               <div class="success sent-success" id="sent-success">
                                                              Вам выслана ссылка! Используйте ее для восстановления пароля!
                                                               </div>

                                                               <div class="sent-errors" id="sent-errors" style="display:none;color:#ff0000;font-weight:bold;">
                                                               Учётная запись не найдена!
                                                               </div>


                                                          </div>
                                                          <div class="row">
                                                               <label id="inlineFormInputGroup-username-error" class="error" for="recover_username"></label>
                                                          </div>
                                                          <div class="row">
                                                               <label id="inlineFormInputGroup-email-error" class="error" for="recover_email"></label>
                                                          </div>


                                             </div>
                                      </div>
                               </div>

                              <div class="container-fluid">
                                                 <label for="reset_username"><b>Введите Ваш ник (имя пользователя)</b></label>
                                                 <input id="reset_username" name="reset_username" type="text" required />

                                                 <label for="reset_email"><b>Введите Ваш адрес эл.почты (имейл)</b><label>
                                                        <input id="reset_email" type="text" placeholder="" name="reset_email" required>




                                                        <button id="send-reset-link" style="background:#4a4a4a;" type="button">
                                                        Получить ссылку
                                                        </button>



                                                     
                                  </label>

                              </div>


                   </form>

                   
               </div>

              {% if  is_reset_required %}
               <div class="modal-login modaldialogue"  id="reset-password-modal" style="display:block;">

                         <div class="modal-header">
                             <div class="container-fluid">
                                <div class="row">
                                     <div class="col-sm-10">
                                      <label><b>
                                      <span>
Восстановить пароль
                                      </span>
                                      </b></label>
                                     </div>
                                     <div class="col-sm-2" id="reset-password-modal-close"><div style="float:right;">x</div><div class="clear"></div></div>
                                </div>
                             </div>
                        </div>

                          <form id="recover-password-steptwo" name="recover-password-steptwo" enctype="multipart/form-data" method="POST">
                              {% csrf_token %}


                    <div class="modal-body">
                            <div class="container-fluid">
                                      <div class="row">
                                             <div class="col-sm-12">
                                                    <div class="container-fluid" style="margin-left:0.4em;">
                                                          <div class="row">

                                                               <div class="success recover-success" id="recover-success">
                                                                       Пароль успешно изменён!
                                                               </div>

                                                               <div class="errors recover-errors" id="recover-errors" style="display:none;color:#ff0000;font-weight:bold;">
                                                                       Не удалось восстановить пароль!
                                                               </div>



                                                               <div class="success change-success" id="change-success">
                                                                      С▒~Bа▒~@▒~Kй па▒~@ол▒~L ▒~C▒~Aпе▒~Hно измен▒~Qн!
                                                               </div>


                                                               <div class="change-errors" id="change-errors" style="display:none;">
                                                                      С▒~Bа▒~@▒~Kй па▒~@ол▒~L не найден!
                                                               </div>
                                                          </div>
                                                          <div class="row">
                                                               <label id="inlineFormInputGroup-newpassword_recover-error" class="error" for="newpassword_recover"></label>
                                                          </div>

                                                          <div class="row">
                                                               <label id="inlineFormInputGroup-newpassword_recover_confirmed-error" class="error" for="newpassword_recover_confirmed"></label>
                                                          </div>
                                                   </div>
                                            </div>
                                     </div>
                          </div>



                              <div class="container-fluid">

                                                 <label for="newpassword_recover"><b>Введите новый пароль</b></label>
                                                        <input id="newpassword_recover" type="password" placeholder="" name="newpassword_recover" required>
                                                 <label for="newpassword_recover_confirmed"><b> 
                                                         Подтвердите новый пароль
                                                        </b></label>
                                                        <input id="newpassword_recover_confirmed" type="password" placeholder="" name="newpassword_recover_confirmed" required>




                                                        <button id="password-recover-publish" style="background:#4a4a4a;" type="button">
                                                         Сохранить
                                                        </button>



                              </div>
                    </div>

                   </form>

               </div>

                {% endif %}








               <div class="modal-login modaldialogue"  id="change-password-modal">

                         <div class="modal-header">
                             <div class="container-fluid">
                                <div class="row">
                                     <div class="col-sm-10">
                                      <label><b>
                                      <span>
Сменить Пароль
                                      </span>
                                      </b></label>
                                     </div>
                                     <div class="col-sm-2" id="change-password-modal-close"><div style="float:right;">x</div><div class="clear"></div></div>
                                </div>
                             </div>
                        </div>

                          <form id="changepassword" enctype="multipart/form-data" method="POST">
                              {% csrf_token %}


                    <div class="modal-body">

                            <div class="container-fluid">
                                      <div class="row">
                                             <div class="col-sm-12">
                                                    <div class="container-fluid" style="margin-left:0.4em;">
                                                          <div class="row">
                                                               <div class="success change-success" id="change-success"> 
                                                                      Старый пароль успешно изменён!      
                                                               </div>
                                                          

                                                               <div class="change-errors" id="change-errors" style="display:none;">
                                                                      Старый пароль не найден!
                                                               </div>
                                                          </div>
                                                          <div class="row">
                                                               <label id="inlineFormInputGroup-oldpassword-error" class="error" for="oldpassword"></label>
                                                          </div>
                                                          <div class="row">
                                                               <label id="inlineFormInputGroup-newpassword-error" class="error" for="newpassword"></label>
                                                          </div>

                                                          <div class="row">
                                                               <label id="inlineFormInputGroup-newpassword_confirmed-error" class="error" for="newpassword_confirmed"></label>
                                                          </div>
                                                   </div>
                                            </div>
                                     </div>
                          </div>



                              <div class="container-fluid">
                                                 <label for="uname"><b>Введите существующий пароль</b></label>
                                                 <input id="oldpassword" name="oldpassword" type="password" required />

                                                 <label for="newpassword"><b>Введите новый пароль</b></label>
                                                        <input id="newpassword" type="password" placeholder="" name="newpassword" required>
                                                 <label for="newpassword_confirmed"><b>Введите новый пароль еще раз</b></label>
                                                        <input id="newpassword_confirmed" type="password" placeholder="" name="newpassword_confirmed" required>




                                                        <button id="password-change" style="background:#4a4a4a;" type="button">
                                                        Сохранить 
                                                        </button>



                              </div>
                    </div>

                   </form>

               </div>

               <div class="modal-login modaldialogue" id="modal-login" name="modal-login">
                         <div class="modal-header">
                             <div class="container-fluid">
                                <div class="row">
                                     <div class="col-sm-10">
                                      <label><b>
                                      <span>Зайти на сайт</span>
                                      </b></label>
                                     </div>
                                     <div class="col-sm-2" id="modal-login-close"><div style="float:right;">x</div><div class="clear"></div></div>
                                </div> <!-- row ends -->
                             </div> <!-- container ends-->

                             

                    </div>
                    <div style="height:1.4em;text-align:center; font-weight:0.8em;">
                          <div class="errors"><span>Ошибка. Попытайтесь ещё раз.</span> </div>
                          <div class="errors" id="modal-error"><span><a href="#" id="retry-activation" class="error">Активировать?</a></span> </div>
                    </div>
                    <div class="modal-body">

                              <form id="authenticateform" action="/signin/" name="authenticateform" method="POST">
                              {% csrf_token %}


                              <div class="container-fluid">



                                        
 
                                         <div class="row">
                                                 <label for="uname"><b>Имя Пользователя</b></label>
                                                 <input id="login_username" type="text" name="login_username" placeholder="Имя пользователя ..." required />

                                         </div>
                                        <div class="row" style="margin-left:-1.8em;overflow:hidden;">
                                                 <label id="inlineFormInputGroup-login_username-error" class="login-errors error" for="login_username"></label>
                                        </div>

                                        <div class="row">
                                                 <label for="psw"><b>Пароль</b></label>
                                                        <input id="login_password" type="password" name="login_password" placeholder="Пароль..." />
                                        </div>

                                        <div class="row" style="margin-left:-1.8em;overflow:hidden;">
                                             <label id="inlineFormInputGroup-login_password-error" class="login-errors error" for="login_password"></label>
                                        </div>

                                        <div class="row">
                                                        <button id="user-login" style="background:#4a4a4a;" type="button">Войти</button> 
                                        </div>


 <!--
                                        <div class="row">
                                                 <div class="col-sm-12">
                                                       <span class="psw">▒~Wаб▒~Kли <a href="#">па▒~@ол▒~L?</a></span>
                                                 </div>
                                        </div>
-->
                                         <div class="row">
                                                    <div class="col-sm-6">
                                                               <a id="modal-register-open" 
                                                                        href="/register" style="color:dodgerblue">Зарегистрироваться
                                                               </a> 
                                                    </div>
                                                    <div class="col-sm-6">
                                                    </div>
                                         </div>
                                         <div class="row">
                                                    <div class="col-sm-8">
                                                               <a id="send-reset-link-modal-open" href="#">
                                                                   Забыли пароль?
                                                               </a>
                                                    </div>
                                                    <div class="col-sm-4">

                                                    </div>
                                         </div>


                                   </div>

                              </div>
                         </form>
                    </div>
               </div>

{% block content %}
{% endblock %}
<div class="fluid-container">
    <div class="row footer-row">
       <div class="col-sm-4"></div>

       <div class="col-sm-4 footer">
           <div>Любовь и Ненависть 2018</div>
           <div>info[a]lovehate.io</div>
       </div>
 
       <div class="col-sm-4"></div>
    </div>
</div>
</body>
<script>

       var i = 0;
       var speed = 300; /* The speed/duration of the effect in milliseconds */

       function typeWriter(txt) {
          if (i < txt.length) {
               document.getElementById("runner").innerHTML += txt.charAt(i);
               i++;
               setTimeout(typeWriter, speed);
          } 
       }

       function line_one() {

           var l = $('#runner-index').html();
           
           if (l=='One') {
                 $('#runner').css('display', 'block');
             //    var text = "Чтобы был хороший стул";
                 var text = "Eсли не удаётся авторизоваться";
                 $('#runner-index').html('Two');
            //     typeWriter(text);
                 $('#runner').html('<p class="line-1 anim-typewriter">'+text+'</p>')
           } else if (l=='Two') {
                  $('#runner').css('display', 'block');
                // var text = "должен быть хороший стол.";
                 var text = "пишите на dmitryro@gmail.com";
                 $('#runner-index').html('Three');
              //   typeWriter(text);
                 $('#runner').html('<p class="line-1 anim-typewriter">'+text+'</p>');
           } else {
                  $('#runner').css('display', 'block');
                // var text = "должен б▒~K▒~B▒~L ▒~Eо▒~@о▒~Hий ▒~A▒~Bол.";
                 var text = "Разослано новостное письмо";
                 $('#runner-index').html('One');
              //   typeWriter(text);
                 $('#runner').html('<p class="line-1 anim-typewriter">'+text+'</p>');
           }
           
            
           return false;
       }


       $(document).ready(function() {
       $('#runner').html('Чтобы был хороший стул');
       $('#runner').css('display', 'none');
       $('#runner-index').html('One');       
       setInterval(line_one, 3000);








/*
            $(document).mouseup(function(e)  {
                var container = $("#modal-login");

                if (!container.is(e.target) && container.has(e.target).length === 0) 
                {
                     container.hide();
                }
            });
*/
            $(document).mouseup(function(e)  {
                var container = $("#send-reset-link-modal");

                // if the target of the click isn't the container nor a descendant of the container
                if (!container.is(e.target) && container.has(e.target).length === 0)
                {
                     container.hide();
                }
            });

            $(document).mouseup(function(e)  {
                var container = $("#modal-send-activation");

                // if the target of the click isn't the container nor a descendant of the container
                if (!container.is(e.target) && container.has(e.target).length === 0)
                {
                     container.hide();
                }
            });

            var attitude = { love:1, indifferent:2, hate:3 };
            $('#comment').html('');
            $('#feeling').html('');
            $('#message').html('');
            $('#comment').html($('#comment-body').val());
            $('#blogedit_post').html($('#blog_body_edit').val());
            $('#bio').html($('#profile_bio').val());
            $('#forumedit_feeling').html($('#emotion_emotion').val());
            $('#blognew_post').html('');
            $("#activation-success" ).fadeIn( 200 ).delay( 500 ).fadeOut( 300 );
            $("#activation-failure" ).fadeIn( 200 ).delay( 500 ).fadeOut( 300 );
            $("#retry-activation").click(function() {
            });
            
            $('#submenu-main').show();
            $('#submenu-forum').hide();
            $('#submenu-blog').hide();
            $('#submenu-mylh').hide(); 
            $('#submenu-statistics').hide();
            $('#submenu-private-messages').hide();

            $('#change_password').click(function(event) {
                $('#change-password-modal').show();
            });
           
            $('#reset-password-modal-close').click(function(event) {
                   $("#reset-password-modal").hide();
            });

            $('#send-reset-link-modal-open-activate').click(function(event) {
                   $('#modal-send-activation').hide();
                   $('#send-reset-link-modal').show();
            });

            $('#send-reset-link-modal-open').click(function(event) {
                   $('#modal-login').hide();
                   $('#send-reset-link-modal').show();
            });

            $('#send-reset-link-modal-close').click(function(event) {
                  $('#send-reset-link-modal').hide();
            });

            $('#change-password-modal-close').click(function(event) {
                $('#change-password-modal').hide();
           });

            if ($('#current_page').val()==='relationships') {
                       $('#submenu-main').hide();
                       $('#submenu-forum').hide();
                       $('#submenu-blog').hide();
                       $('#submenu-mylh').show();
                       $('#submenu-statistics').hide();
                       $('#submenu-private-messages').hide();
                       $('.active').removeClass('active');
                       $('#submenu-div-4').addClass('active');
            } else if ($('#current_page').val()==='mylh' || $('#current_page').val()==='mylh_settings') {
                       $('#submenu-main').hide();
                       $('#submenu-forum').hide();
                       $('#submenu-blog').hide();
                       $('#submenu-mylh').show();
                       $('#submenu-statistics').hide();
                       $('#submenu-private-messages').hide();
                       $('.active').removeClass('active');
                       $('#submenu-div-4').addClass('active');
            } else if ($('#current_page').val()==='forum') {
                       $('#submenu-main').hide();
                       $('#submenu-forum').show();
                       $('#submenu-blog').hide();
                       $('#submenu-mylh').hide();
                       $('#submenu-statistics').hide();
                       $('#submenu-private-messages').hide();
                       $('.active').removeClass('active');
                       $('#submenu-div-2').addClass('active');
            } else if ($('#current_page').val()==='blog') {
                       $('#submenu-main').hide();
                       $('#submenu-forum').hide();
                       $('#submenu-blog').show();
                       $('#submenu-mylh').hide();
                       $('#submenu-statistics').hide();
                       $('#submenu-private-messages').hide();
                       $('.active').removeClass('active');
                       $('#submenu-div-3').addClass('active');
            } else if ($('#current_page').val()==='statistics') {
                       $('#submenu-main').hide();
                       $('#submenu-forum').hide();
                       $('#submenu-blog').hide();
                       $('#submenu-mylh').hide();
                       $('#submenu-statistics').show();
                       $('#submenu-private-messages').hide();
                       $('.active').removeClass('active');
                       $('#submenu-div-6').addClass('active');
            } else if ($('#current_page').val()==='private' || $('#current_page').val()==='private_contacts' || $('#current_page').val()==='private_settings') {
                       $('#submenu-main').hide();
                       $('#submenu-forum').hide();
                       $('#submenu-blog').hide();
                       $('#submenu-mylh').hide();
                       $('#submenu-statistics').hide();
                       $('#submenu-private-messages').show();
                       $('.active').removeClass('active');
                       $('#submenu-div-5').addClass('active');
            } else if ($('#current_page').val()==='outgoing') {
                       $('#submenu-main').hide();
                       $('#submenu-forum').hide();
                       $('#submenu-blog').hide();
                       $('#submenu-mylh').hide();
                       $('#submenu-statistics').hide();
                       $('#submenu-private-messages').show();
                       $('.active').removeClass('active');
                       $('#submenu-div-5').addClass('active');

            } else if ($('#current_page').val()==='new_blog') {
                       $('#submenu-main').hide();
                       $('#submenu-forum').hide();
                       $('#submenu-blog').show();
                       $('#submenu-mylh').hide();
                       $('#submenu-statistics').hide();
                       $('#submenu-private-messages').hide();
                       $('.active').removeClass('active');
                        $('#submenu-div-3').addClass('active');

            } else if ($('#current_page').val()==='new_comment') {
                       $('#submenu-main').hide();
                       $('#submenu-forum').hide();
                       $('#submenu-blog').show();
                       $('#submenu-mylh').hide();
                       $('#submenu-statistics').hide();
                       $('#submenu-private-messages').hide();
                       $('.active').removeClass('active');
                       $('#submenu-div-3').addClass('active');

            } else if ($('#current_page').val()==='blog_comments') {
                       $('#submenu-main').hide();
                       $('#submenu-forum').hide();
                       $('#submenu-blog').show();
                       $('#submenu-mylh').hide();
                       $('#submenu-statistics').hide();
                       $('#submenu-private-messages').hide();
                       $('.active').removeClass('active');
                       $('#submenu-div-3').addClass('active');
            } else if ($('#current_page').val()==='user_blog') {
                       $('#submenu-main').hide();
                       $('#submenu-forum').hide();
                       $('#submenu-blog').show();
                       $('#submenu-mylh').hide();
                       $('#submenu-statistics').hide();
                       $('#submenu-private-messages').hide();
                       $('.active').removeClass('active');
                       $('#submenu-div-3').addClass('active');
            }

            else if ($('#current_page').val()==='incoming') {
                       $('#submenu-main').hide();
                       $('#submenu-forum').hide();
                       $('#submenu-blog').hide();
                       $('#submenu-mylh').hide();
                       $('#submenu-statistics').hide();
                       $('#submenu-private-messages').show();
                       $('.active').removeClass('active');
                       $('#submenu-div-5').addClass('active');
            }



            $('.menu-item').click(function(event) {
                   event.preventDefault();
                   $('.active').removeClass('active');
                   $(this).addClass('active');

                   if ($(this).attr('id')==='submenu-div-1') {
                       var url = '/';
                       window.location.href = url;
                       $('#submenu-main').show();
                       $('#submenu-forum').hide();
                       $('#submenu-blog').hide();
                       $('#submenu-mylh').hide();
                       $('#submenu-statistics').hide();
                       $('#submenu-private-messages').hide();
                   } else if ($(this).attr('id')==='submenu-div-2') {
                       var url = '/forum/';
                       window.location.href = url;
                       $('#submenu-main').hide();
                       $('#submenu-forum').show();
                       $('#submenu-blog').hide();
                       $('#submenu-mylh').hide();
                       $('#submenu-statistics').hide();
                       $('#submenu-private-messages').hide();
                   } else if ($(this).attr('id')==='submenu-div-3') {
                       var url = '/blog/';
                       window.location.href = url;
                       $('#submenu-main').hide();
                       $('#submenu-forum').hide();
                       $('#submenu-blog').show();
                       $('#submenu-mylh').hide();
                       $('#submenu-statistics').hide();
                       $('#submenu-private-messages').hide();
                   } else if ($(this).attr('id')==='submenu-div-4') {
                       var url = '/mylh/';
                       window.location.href = url;
                       $('#submenu-main').hide();
                       $('#submenu-forum').hide();
                       $('#submenu-blog').hide();
                       $('#submenu-mylh').show();
                       $('#submenu-statistics').hide();
                       $('#submenu-private-messages').hide();
                   } else if ($(this).attr('id')==='submenu-div-5') {
                       var url = '/private/';
                       window.location.href = url;
                       $('#submenu-main').hide();
                       $('#submenu-forum').hide();
                       $('#submenu-blog').hide();
                       $('#submenu-mylh').hide();
                       $('#submenu-statistics').hide();
                       $('#submenu-private-messages').show();
                   } else if ($(this).attr('id')==='submenu-div-6') {
                       var url = '/statistics/';
                       window.location.href = url;
                       $('#submenu-main').hide();
                       $('#submenu-forum').hide();
                       $('#submenu-blog').hide();
                       $('#submenu-mylh').hide();
                       $('#submenu-statistics').show();
                       $('#submenu-private-messages').hide();
                   }
            });
            if ($('#current_page').val()==='new_feeling') {
                       $("#resend-activation-errors").hide(); 
                       $('#submenu-main').hide();
                       $('#submenu-forum').show();
                       $('#submenu-blog').hide();
                       $('#submenu-mylh').hide();
                       $('#submenu-statistics').hide();
                       $('#submenu-private-messages').hide();
                       $('.active').removeClass('active');
                       $('#submenu-div-2').addClass('active');
            }
            
            $('#newfriendform').validate({

                      rules: {
                //            friend_username: "required",
                      },
                      highlight: function (element) {
                            $(element).closest('.control-group').removeClass('success').addClass('error');
                      },
                      success: function (element) {
                           element.text('').addClass('valid')
                              .closest('.control-group').removeClass('error').addClass('success');
                      },
                      messages: {
                  //         friend_username: {
                   //            required: "Введите ник будущего друга!"
                    //       }
                      }



            });

            $('#newenemyform').validate({

                      rules: {
                //            enemy_username: "required",
                      },
                      highlight: function (element) {
                            $(element).closest('.control-group').removeClass('success').addClass('error');
                      },
                      success: function (element) {
                           element.text('').addClass('valid')
                              .closest('.control-group').removeClass('error').addClass('success');
                      },
                      messages: {
                  //         enemy_username: {
                  //             required: "Введите ник будущего врага!"
                  //        }
                      }



            });

            $('#newcommentform').validate({
                      rules: {
                            comment_attitude: "required",
                            comment: "required",
                      },
                      highlight: function (element) {
                            $(element).closest('.control-group').removeClass('success').addClass('error');
                      },
                      success: function (element) {
                           element.text('').addClass('valid')
                              .closest('.control-group').removeClass('error').addClass('success');
                      },
                      messages: {  
                           comment: {
                               required: "Введите ваш комментарий!",
                           },
                           comment_attitude: {
                               required: "?~R?~K?~Aкажи?~Bе ?~Aвое о?~Bно?~Hение к о?~B?~A?~Kлаемом?~C!",
                           },               
                      }
            }); 

            $('#editprofileform').validate({
                      rules: {
                            profile_username: {
                                     required: true,
                                     minlength: 1
                            },
                            profile_email: {
                                     required: true,
                                     email: true
                            }

                      },
                      highlight: function (element) {
                            $(element).closest('.control-group').removeClass('success').addClass('error');
                      },
                      success: function (element) {
                           element.text('').addClass('valid')
                              .closest('.control-group').removeClass('error').addClass('success');
                      },
                      messages: {
                           profile_email: {
                               required: "Введите адрес электронной почты!",
                               email: "Неверный формат электронной почты!",
                           },
                           profile_username: {
                               required: "Введите ник (имя пользователя)!",
                           },
                      }                          
      
            });

            $('#newcommentunauthform').validate({
                      rules: {
                            comment_attitude: "required",
                            comment_username: "required",
                            comment_password: "required",
                            comment: "required",
                      },
                      highlight: function (element) {
                            $(element).closest('.control-group').removeClass('success').addClass('error');
                      },
                      success: function (element) {
                           element.text('').addClass('valid')
                              .closest('.control-group').removeClass('error').addClass('success');
                      },
                      messages: {
                           comment: {
                               required: "Введите Ваш Комментарий!",
                           },
                           comment_attitude: {
                               required: "Выскажите свое отношение к опубликованному!",
                           },
                           comment_username: {
                               required: "Введите Ваш Ник!",
                           },
                           comment_password: {
                               required: "Введите Ваш Пароль!",
                           },

                      }
            });

            $("#recover-password").validate({

                      rules: {
                            reset_username: {
                                     required: true,
                                     minlength: 1
                            },
                            reset_email: {
                                     required: true,
                                     email: true
                            },

                      },
                      highlight: function (element) {
                            $(element).closest('.control-group').removeClass('success').addClass('error');
                      },
                      success: function (element) {
                           element.text('').addClass('valid')
                              .closest('.control-group').removeClass('error').addClass('success');
                      },
                      messages: {

                           reset_username: {
                               required: "Введите имя пользователя!",
                               minlength: "Имя пользователя минимум 1 символ!",
                           },
                           reset_email: {
                               required:"Введите адрес электронной почты!", 
                               email: "Неверный формат электронной почты!", 
                           },

                      }



            });

            $('#recover-password-steptwo').validate({
                   rules: {
                            newpassword_recover: {
                                     required: true,
                                     minlength: 8
                            },
                            newpassword_recover_confirmed: {
                                     required: true,
                                     minlength: 8,
                                     equalTo: "#newpassword_recover"
                            }


                      },
                      highlight: function (element) {
                            $(element).closest('.control-group').removeClass('success').addClass('error');
                      },
                      success: function (element) {
                           element.text('').addClass('valid')
                              .closest('.control-group').removeClass('error').addClass('success');
                      },
                      messages: {

                           newpassword_recover_confirmed: {
                               required: "Подтвердите новый пароль!",
                               minlength: "Пароль должен быть минимум 8 символов!",
                               equalTo:  "Подтверждение должно быть идентично!",
                           },
                           newpassword_recover: {
                               required: "Введите новый пароль!",
                               minlength: "Пароль должен быть минимум 8 символов!",
                           },



                      }

            });



            $('#changepassword').validate({
                      rules: {
                            oldpassword: {
                                     required: true,
                                     minlength: 8
                            },
                            newpassword: {
                                     required: true,
                                     minlength: 8
                            },
                            newpassword_confirmed: {
                                     required: true,
                                     minlength: 8,
                                     equalTo: "#newpassword"
                            }


                      },

                      highlight: function (element) {
                            $(element).closest('.control-group').removeClass('success').addClass('error');
                      },
                      success: function (element) {
                           element.text('').addClass('valid')
                              .closest('.control-group').removeClass('error').addClass('success');
                      },
                      messages: {

                           newpassword_confirmed: {
                               required: "Подтверждающий пароль необходим!",
                               minlength: "Подтверждение минимум 8 символов!",
                               equalTo:  "Подтверждение не идентично!",
                           },
                           newpassword: {
                               required: "Новый пароль необходим!",
                               minlength: "Новый пароль - минимум 8 символов!",
                           },
                           oldpassword: {
                               required: "Старый пароль необходим!",
                               minlength: "Старый пароль - минимум 8 символов!",
                           },



                      }

            });

            $('#newmessageform').validate({
                      rules: {
                            message_attitude: "required",
                            message: "required",
                            recipient: "required",
                            subject: {
                                     required: true,
                                     minlength: 2
                            },

                      },
                      highlight: function (element) {
                            $(element).closest('.control-group').removeClass('success').addClass('error');
                      },
                      success: function (element) {
                           element.text('').addClass('valid')
                              .closest('.control-group').removeClass('error').addClass('success');
                      },
                      messages: {
                           subject: {
                               required: "Введите тему сообщения!",
                               minlength: "Введите тему сообщения!"
                           },
                           message: {
                               required: "Введите текст сообщения!",
                               minlength: "Введите текст сообщения!"
                           },
                           recipient: {
                               required: "Введите минимум одного получателя!",
                               minlength: "Введите минимум одного получателя!",
                           },
                           message_attitude: {
                               required: "Выскажите свое отношение к отсылаемому!",
                           },


                     }
             });

            $('#newmessageunauthform').validate({
                      rules: {
                            message_attitude: "required",
                            message: "required",
                            recipient: "required",
                            message_username: "required",
                            message_password: "required",
                            subject: {
                                     required: true,
                                     minlength: 2
                            },

                      },
                      highlight: function (element) {
                            $(element).closest('.control-group').removeClass('success').addClass('error');
                      },
                      success: function (element) {
                           element.text('').addClass('valid')
                              .closest('.control-group').removeClass('error').addClass('success');
                      },
                      messages: {
                           subject: {
                               required: "Введите тему сообщения!",
                               minlength: "Введите тему сообщения!",
                           },
                           message: {
                               required: "Введите текст сообщения!",
                               minlength: "Введите текст сообщения!",
                           },
                           recipient: {
                               required: "Введите минимум одного получателя сообщения!",
                               minlength: "Введите минимум одного получателя сообщения!",
                           },
                           message_attitude: {
                               required: "Выскажите Ваше отношение к теме сообщения!",
                           },
                           "message_username": {
                               required: "Введите ник (имя пользователя)!",
                           },
                           "message_password": {
                               required: "Введите пароль!",
                           }

                     }
             });



            $('#newforumform').validate({
                      rules: {
                            forumnew_attitude: "required",
                            feeling: "required",
                            subject: {
                                     required: true,
                            },

                      },
                      highlight: function (element) {
                            $(element).closest('.control-group').removeClass('success').addClass('error');
                      },
                      success: function (element) {
                           element.text('').addClass('valid')
                              .closest('.control-group').removeClass('error').addClass('success');
                      },
                      messages: {
                           subject: {
                               required: "Название темы не может быть пустым!",
                           },
                           feeling: {
                               required: "Ваше сообщение не может быть пустым!",
                               minlength: "Опишите Ваше отношение не менее чем в десяти символах!"
                           },
                           forumnew_attitude: {
                               required: "Ваше отношение должно быть высказано!",
                           },

 
                     }
             });

            $('#editforumform').validate({
                      rules: {
                            forumedit_attitude: "required",
                            forumedit_subject: {
                                     required: true,
                                     minlength: 1
                            },

                      },
                      highlight: function (element) {
                            $(element).closest('.control-group').removeClass('success').addClass('error');
                      },
                      success: function (element) {
                           element.text('').addClass('valid')
                              .closest('.control-group').removeClass('error').addClass('success');
                      },
                      messages: {
                           forumedit_subject: {
                               required: "Название темы не может быть пустым!",
                               minlength: "Название темы не может быть короче одного символа!",
                           },
                           forumedit_attitude: {
                               required: "Ваше отношение должно быть высказано!",
                           },


                     }
             });

            $('#newunauthforumform').validate({
                      rules: {
                            forumnew_attitude: "required",
                            feeling: "required",
                            forumnew_username: "required",
                            forumnew_password: "required",
                            subject: {
                                     required: true,
                                     minlength: 2
                            },

                      },
                      highlight: function (element) {
                            $(element).closest('.control-group').removeClass('success').addClass('error');
                      },
                      success: function (element) {
                           element.text('').addClass('valid')
                              .closest('.control-group').removeClass('error').addClass('success');
                      },
                      messages: {
                           subject: {
                               required: "Название темы не может быть пустым!",
                               minlength: "Название темы не может быть пустым!",
                           },
                           feeling: {
                               required: "Сообщение не может быть пустым!",
                               minlength: "Сообщение не может быть пустым!",
                           },
                           forumnew_attitude: {
                               required: "Ваше относение к публикуемому должно быть высказано!",
                           },
                           forumnew_username: {
                               required: "Имя Пользователя (Ник) Обязательно для заполнения!",
                           },
                           forumnew_password: {
                               required: "Пароль Обязателен для заполнения!",
                           }




                     }
             });


            $('#editblogform').validate({
                      rules: {
                            blogedit_attitude: "required",
                //            blogedit_post: "required",
                            blogedit_subject: {
                                     required: true,
                                     minlength: 2
                            },

                      },
                      highlight: function (element) {
                            $(element).closest('.control-group').removeClass('success').addClass('error');
                      },
                      success: function (element) {
                           element.text('').addClass('valid')
                              .closest('.control-group').removeClass('error').addClass('success');
                      },
                      messages: {
                           blogedit_subject: {
                               required: "Введите тему сообщения!",
                               minlength: "Введите тему сообщения!",
                           },
/*
                           blogedit_post: {
                               required: "Введите текст сообщения!",
                               minlength: "Введите текст сообщения!",
                           },
*/
                           blogedit_attitude: {
                               required: "Выскажите свое отношение к публикуемому!"
                           },


                     }

            });

            $('#newblogform').validate({
                      rules: {
                            blognew_attitude: "required",
                            blognew_post: "required",
                            blognew_subject: {
                                     required: true,
                                     minlength: 2
                            },

                      },
                      highlight: function (element) {
                            $(element).closest('.control-group').removeClass('success').addClass('error');
                      },
                      success: function (element) {
                           element.text('').addClass('valid')
                              .closest('.control-group').removeClass('error').addClass('success');
                      },
                      messages: {
                           blognew_subject: {
                               required: "Введите тему сообщения!",
                               minlength: "Введите тему сообщения!",
                           },
                           blognew_post: {
                               required: "Введите текст сообщения!",
                               minlength: "Введите текст сообщения!",
                           },
                           blognew_attitude: {
                               required: "Выскажите свое отношение к публикуемому!",
                           },


                     }
             });


            $('#newblogunauthform').validate({
                      rules: {
                            blognew_attitude: "required",
                            blognew_post: "required",
                            blognew_username: "required",
                            blognew_password: "required",
                            blognew_subject: {
                                     required: true,
                                     minlength: 2
                            },

                      },
                      highlight: function (element) {
                            $(element).closest('.control-group').removeClass('success').addClass('error');
                      },
                      success: function (element) {
                           element.text('').addClass('valid')
                              .closest('.control-group').removeClass('error').addClass('success');
                      },
                      messages: {
                           blognew_subject: {
                               required: "Тема сообщеняи обязательна!",
                               minlength: "Тема сообщеняи обязательна!",
                           },
                           blognew_post: {
                               required: "Текст сообщения обязателен!",
                               minlength: "Текст сообщения обязателен!",
                           },
                           blognew_attitude: {
                               required: "Выскажите свое отношение к публикуемому!",
                           },
                           blognew_username: {
                               required: "Ник (имя пользователя) обязателен!",
                           },
                           blognew_password: {
                               required: "Пароль обязателен!",
                           }

                     }
             });
            $('#authenticateform').validate({
                      rules: {
                             login_username:   "required",
                             login_password: {
                                      required: true,
                                      minlength: 8
                             }                 
                      },
                      highlight: function (element) {
                            $(element).closest('.control-group').removeClass('success').addClass('error');
                      },
                      success: function (element) {
                           element.text('').addClass('valid')
                              .closest('.control-group').removeClass('error').addClass('success');
                      },
                      messages: {
                           login_username: {
                               required: "Ник (имя пользователя) обязателен!",
                           },
                           login_password: {
                               required: "Пароль обязателен!",
                               minlength: "Пароль минимум 8 символов!",
 
                           },
                      }

            });
         
            $('#registration').validate({
                      rules: {
                            register_username: {
                                     minlength: 1,
                                     required: true
                            },
                            register_password: {
                                     required: true,
                                     minlength: 8
                            },
                            register_email: {
                                     required: true,
                                     email: true
                            },
/*
                            register_name: {
                                     required: true,
                                     minlength: 2
                            },
                            register_confirm_password: {
                                     required: true,
                                     minlength: 8,
                                     equalTo: "#register_password"
                            }
*/
                      },
                      highlight: function (element) {
                            $(element).closest('.control-group').removeClass('success').addClass('error');
                      },
                      success: function (element) {
                           element.text('').addClass('valid')
                              .closest('.control-group').removeClass('error').addClass('success');
                      },
                      messages: {
                           register_username: {
                               required: "Введите имя пользователя!",
                               minlength: "Имя пользователя должно быть длиной не менее 5 символов!"
                           },
                           register_password: {
                               required: "Введите пароль!",
                               minlength: "Ваш пароль должен быть длиной не меньше 8 символов!"
                           },
/*
                           register_confirm_password: {
                               required: "Подтвердите пароль!",
                               minlength: "Ваш пароль должен быть длиной не меньше 8 символов!",
                               equalTo: "Ваш подтверждающий пароль должен быть идентичен!"
                           },
                           register_name: {
                               required: "Введите полное имя или имя собственное!",
                               minlength: "Ваше имя должно быть длиной не меньше 2 символов!",
                           },
*/
                           register_email: {
                               required: "Введите адрес электронной почты!",
                               email: "Используйте формат электронной почты!"    
                           }
                     }
              });
              $('div.errors').hide();
              $('#modal-login').hide();      
              $('#modal-send-activation').hide();
              $('#modal-send-activation-close').click(function() {
                  $('#modal-send-activation').hide();
              });
              $('#modal-login-close').click(function() {
                  $('#modal-login').hide();
              });
              $('#modal-login-open').click(function() {
                  $('#modal-register').hide();
              });
              
              $('#modal-login-open').click(function() {
                  $('.login-errors').hide();
                  $('#login_username').attr('value','');
                  $('#login_password').attr('value','');
                  $('#modal-login').show();
              });
             
              $('#newfriendform-publish').click(function() {
                  if($("#newfriendform").valid()) {
                         var friends_check_box_values = $('#newfrienddeleteform [name="friends_delete"]:checked').map(function () {
                             return this.value;
                         }).get();


                         var user_id = $("#user_id").val();


                         var arr = {
                              username: $("#friend_username").val(),
                              user_id: user_id,
                              friends_delete: friends_check_box_values,
                         };


                         $.ajax({
                             type: "POST",
                             url: "https://lovehate.io/addnewfriend/",
                             data: JSON.stringify(arr),
                             dataType: 'json',
                             contentType: "application/json; charset=utf-8",
                             success: function(data){
                                 redirect_url('relationships'+'/'+user_id+'/');
                             },
                             error: function(data){
                                 $( ".friend-errors" ).fadeIn( 100 ).delay( 1000 ).fadeOut( 300 );
                             }

                         });



                  }
              });

              $('#newenemyform-publish').click(function() {

                  var enemies_check_box_values = $('#newenemydeleteform [name="enemies_delete"]:checked').map(function () {
                             return this.value;
                  }).get();

                  if($("#newenemyform").valid()) {
                         var user_id = $("#user_id").val();
                         var arr = {
                              username: $("#enemy_username").val(),
                              user_id: user_id,
                              enemies_delete: enemies_check_box_values,
                         };

                         $.ajax({
                             type: "POST",
                             url: "https://lovehate.io/addnewenemy/",
                             data: JSON.stringify(arr),
                             dataType: 'json',
                             contentType: "application/json; charset=utf-8",
                             success: function(data){
                                 redirect_url('relationships'+'/'+user_id+'/');
                             },
                             error: function(data){
                                 $( ".enemy-errors" ).fadeIn( 100 ).delay( 1000 ).fadeOut( 300 );
                             }

                         });


                  }
              });


              $('#send-reset-link').click(function() {
                     if($("#recover-password").valid()) {

                         var arr = {
                          username: $("#reset_username").val(),
                          email: $("#reset_email").val(),
                         };

                         $.ajax({
                             type: "POST",
                             url: "https://lovehate.io/recoverpassword/",
                             data: JSON.stringify(arr),
                             dataType: 'json',
                             contentType: "application/json; charset=utf-8",
                             success: function(data){
                                 $( ".sent-success" ).fadeIn(300).delay(1000).fadeOut(300).promise().done(function() {
                                         wait(1000);
                                         $('#send-reset-link-modal').hide();
                                 });
                             },
                             error: function(data){
                                 $( ".sent-errors" ).fadeIn( 100 ).delay( 1000 ).fadeOut( 300 );
                             }

                         });



                     }
              });

              // Variable to store your files
              var files;

              // Add events
              $('input[type=file]').on('change', prepareUpload);

              // Grab the files and set them to our variable
              function prepareUpload(event)
              {
                    files = event.target.files;
              }
              
              $('#editprofile-publish').click(function(event) {
                  if($('#editprofileform').valid()) {
                      
                       event.stopPropagation(); // Stop stuff happening
                       event.preventDefault(); // Totally stop stuff happening
                      $('#editprofileform').submit();

                       // START A LOADING SPINNER HERE

                       // Create a formdata object and add the files

/*
                      var arr = {
                          user_id: $('#user_id').val(),
                          username: $("#profile_username").val(),
                          session_username:  $("#session_user_name").val(),
                          first_name: $("#first_name").val(),
                          last_name: $("#last_name").val(),
                          email: $("#profile_email").val(),
                          bio: $("#bio").val(),
                      };

                       $.each(files, function(key, value) {
                              arr[key] = value;
                      });

                       
                      $.ajax({
                          type: "POST",
                          url: "https://lovehate.io/saveprofile/",
                          data: JSON.stringify(arr),
                          dataType: 'json',
                          processData: false,
                          contentType: "application/json; charset=utf-8",

                          success: function(data){
                              $( ".profile-success" ).fadeIn(300).delay(1000).fadeOut(300).promise().done(function() {
                                     wait(1000);
                                     redirect_url('mylh/');
                              });
                          },
                          error: function(data){
                              $( ".profile-errors" ).fadeIn( 100 ).delay( 1000 ).fadeOut( 300 );
                          }
                      }); // end ajax call
               */  
              } 

              });  

              $('#password-recover-publish').click(function(event) {
                   if ($('#recover-password-steptwo').valid()) {

                      var arr = {
                          password: $("#newpassword_recover").val(),
                          user_id: $("#reset_user_id").val(),
                      };

         
                      $.ajax({
                          type: "POST",
                          url: "https://lovehate.io/updatepassword/",
                          data: JSON.stringify(arr),
                          dataType: 'json',
                          contentType: "application/json; charset=utf-8",

                          success: function(data){
                              $( ".recover-success" ).fadeIn(300).delay(1000).fadeOut(300).promise().done(function() {
                                     wait(1000);

                                     $('#reset-password-modal').hide();
                              });
                          },
                          error: function(data){

                              $( ".recover-errors" ).fadeIn( 100 ).delay( 1000 ).fadeOut( 300 );
                          }
                      }); // end ajax call



                  }

              });
              $('#newcommentunauth-publish').click(function(event) {
                  if (  $('#newcommentunauthform').valid() ) {
                      var arr = {
                          body: $("#comment").val(),
                          attitude: attitude[$('input[type=radio][name=comment_attitude]:checked').val()],
                          title: $("#comment_subject").val(),
                          user_id: $("#comment_user_id").val(),
                          post_id: $("#comment_post_id").val(),
                          comment_id: $("#comment_id").val(),
                          comment_username:  $("#comment_username").val(),
                          comment_password:  $("#comment_password").val(),
                      };                       
                      $.ajax({
                          type: "POST",
                          url: "https://lovehate.io/addnewcommentunauth/",
                          data: JSON.stringify(arr),
                          dataType: 'json',
                          contentType: "application/json; charset=utf-8",

                          success: function(data){
                              redirect_url('blog/'+$("#comment_post_id").val()+"/comments");
                          },
                          error: function(data){
                              $(".comment-errors" ).fadeIn( 100 ).delay( 1000 ).fadeOut( 300 );
                          }
                      }); // end ajax call


                  }
              });
 
              $('#newcomment-publish').click(function(event) {
                  if ($('#newcommentform').valid()) {

                      var arr = {
                          body: $("#comment").val(),
                          attitude: attitude[$('input[type=radio][name=comment_attitude]:checked').val()],
                          title: $("#comment_subject").val(),
                          user_id: $("#comment_user_id").val(),
                          post_id: $("#comment_post_id").val(),
                          comment_id: $("#comment_id").val()
                      };

                      $.ajax({
                          type: "POST",
                          url: "https://lovehate.io/addnewcomment/",
                          data: JSON.stringify(arr),
                          dataType: 'json',
                          contentType: "application/json; charset=utf-8",

                          success: function(data){
                              redirect_url('blog/'+$("#comment_post_id").val()+"/comments");
                          },
                          error: function(data){
                              $( "div.errors" ).fadeIn( 200 ).delay( 400 ).fadeOut( 300 );
                          }
                      }); // end ajax call
                  }
              });

              $('#editcomment-publish').click(function(event) {
                      var arr = {
                          body: $("#comment").val(),
                          attitude: attitude[$('input[type=radio][name=comment_attitude]:checked').val()],
                          title: $("#comment_subject").val(),
                          user_id: $("#comment_user_id").val(),
                          post_id: $("#comment_post_id").val(),
                          comment_id: $("#comment_id").val()
                      };
                      $.ajax({
                          type: "POST",
                          url: "https://lovehate.io/addnewcomment/",
                          data: JSON.stringify(arr),
                          dataType: 'json',
                          contentType: "application/json; charset=utf-8",

                          success: function(data){
                              redirect_url('blog/'+$("#comment_post_id").val()+"/comments");
                          },
                          error: function(data){
                              $( "div.errors" ).fadeIn( 200 ).delay( 400 ).fadeOut( 300 );
                          }
                      }); // end ajax call
              });

              $('#message-publish').click(function() {
                           
                  if ($('#newmessageform').valid()) {
                      var arr = {
                          message: $("#message").val(),
                          attitude: attitude[$('input[type=radio][name=message_attitude]:checked').val()],
                          subject: $("#subject").val(),
                          recipients: $("#recipient").val(),
                          sender_id: $("#message_user_id").val(),
                      };
                      $.ajax({
                          type: "POST",
                          url: "https://lovehate.io/newmessage/",
                          data: JSON.stringify(arr),
                          dataType: 'json',
                          contentType: "application/json; charset=utf-8",

                          success: function(data){
                             
                              redirect_url('outgoing');
                          },
                          error: function(data){
                              $( "div.errors" ).fadeIn( 200 ).delay( 400 ).fadeOut( 300 );
                          }
                      }); // end ajax call


                  }
              });


              $('#message-unauth-publish').click(function() {

                  if ($('#newmessageunauthform').valid()) {
                      var arr = {
                          message: $("#message").val(),
                          attitude: attitude[$('input[type=radio][name=message_attitude]:checked').val()],
                          subject: $("#subject").val(),
                          recipients: $("#recipient").val(),
                          sender_id: $("#message_user_id").val(),
                          username: $("#message_username").val(),
                          password: $("#message_password").val(),
                      };
                      $.ajax({
                          type: "POST",
                          url: "https://lovehate.io/newmessageunauth/",
                          data: JSON.stringify(arr),
                          dataType: 'json',
                          contentType: "application/json; charset=utf-8",

                          success: function(data){
                              auth($("#message_username").val(), 
                                   $("#message_password").val()); 
                              redirect_url('outgoing');
                          },
                          error: function(data){
                               $(".message-errors" ).fadeIn( 100 ).delay( 1000 ).fadeOut( 300 );
                          }
                      }); // end ajax call


                  }
              });



              $('#blogedit-publish').click(function() {

                  if ($('#editblogform').valid()) {
                      var arr = {
                          post: $("#blogedit_post").val(),
                          attitude: attitude[$('input[type=radio][name=blogedit_attitude]:checked').val()],
                          subject: $("#blogedit_subject").val(),
                          link: $("#blogedit_link").val(),
                          link_two: $("#blogedit_link_two").val(),
                          link_three: $("#blogedit_link_three").val(),
                          link_four: $("#blogedit_link_four").val(),
                          post_id: $('#edited_post_id').val(),
                          user_id: $("#blog_user_id").val(),
                      };

                      $.ajax({
                          type: "POST",
                          url: "https://lovehate.io/updatepost/",
                          data: JSON.stringify(arr),
                          dataType: 'json',
                          contentType: "application/json; charset=utf-8",

                          success: function(data){
                              redirect_url('blog');
                          },
                          error: function(data){
                              $( "div.errors" ).fadeIn( 200 ).delay( 400 ).fadeOut( 300 );
                          }
                      }); // end ajax call


                  }
              });

              $('#blognew-unauth-publish').click(function() {
                   if ($('#newblogunauthform').valid()) {
                      var arr = {
                          post: $("#blognew_post").val(),
                          attitude: attitude[$('input[type=radio][name=blognew_attitude]:checked').val()],
                          subject: $("#blognew_subject").val(),
                          link: $("#blognew_link").val(),
                          link_two: $("#blognew_link_2").val(),
                          link_three: $("#blognew_link_3").val(),
                          link_four: $("#blognew_link_4").val(),
                          username: $("#blognew_username").val(),
                          password: $("#blognew_password").val(),
                      };

                      $.ajax({
                          type: "POST",
                          url: "https://lovehate.io/addnewblogunauth/",
                          data: JSON.stringify(arr),
                          dataType: 'json',
                          contentType: "application/json; charset=utf-8",

                          success: function(data){
                              redirect_url('blog');
                          },
                          error: function(data){
                               $(".blognew-errors" ).fadeIn( 100 ).delay( 1000 ).fadeOut( 300 );
                          }
                      }); // end ajax call

 
 
                   }
              });

              $('#blognew-publish').click(function() {

                  if ($('#newblogform').valid()) {
                      var arr = {
                          post: $("#blognew_post").val(),
                          attitude: attitude[$('input[type=radio][name=blognew_attitude]:checked').val()],
                          subject: $("#blognew_subject").val(),
                          link: $("#blognew_link").val(),
                          link_two: $("#blognew_link_2").val(),
                          link_three: $("#blognew_link_3").val(),
                          link_four: $("#blognew_link_4").val(),
                          user_id: $("#blog_user_id").val(),
                      };

                      $.ajax({
                          type: "POST",
                          url: "https://lovehate.io/addnewblog/",
                          data: JSON.stringify(arr),
                          dataType: 'json',
                          contentType: "application/json; charset=utf-8",

                          success: function(data){
                              redirect_url('blog');
                          },
                          error: function(data){
                              $( "div.errors" ).fadeIn( 200 ).delay( 400 ).fadeOut( 300 );
                          }
                      }); // end ajax call


                  }
              });

              $('#forumnew-unauth-publish').click(function() {

                   if ($('#newunauthforumform').valid()) {

                      var arr = {
                          emotion: $("#feeling").val(),
                          attitude: attitude[$('input[type=radio][name=forumnew_attitude]:checked').val()],
                          subject: $("#subject").val(),
                          username: $("#forumnew_username").val(),
                          password: $("#forumnew_password").val(),
                          user_id: $("#emotion_user_id").val(),
                      };

                      $.ajax({
                          type: "POST",
                          url: "https://lovehate.io/addnewemotionunauth/",
                          data: JSON.stringify(arr),
                          dataType: 'json',
                          contentType: "application/json; charset=utf-8",

                          success: function(data){
                              redirect_main();
                          },
                          error: function(data){
                               $(".forum-errors" ).fadeIn( 100 ).delay( 1000 ).fadeOut( 300 );
                          }
                      }); // end ajax call


                   }
              });

              $('#forumedit-publish').click(function() {
                     if ($('#editforumform').valid()) {
                        var arr = {
                          feeling: $("#forumedit_feeling").val(),
                          attitude: attitude[$('input[type=radio][name=forumedit_attitude]:checked').val()],
                          subject: $("#forumedit_subject").val(),
                          user_id: $("#forumedit_user_id").val(),
                          emotion_id: $("#forumedit_emotion_id").val(),
                        };
            
                      $.ajax({
                          type: "POST",
                          url: "https://lovehate.io/editemotion/",
                          data: JSON.stringify(arr),
                          dataType: 'json',
                          contentType: "application/json; charset=utf-8",

                          success: function(data){
                              redirect_url('forum');
                          },
                          error: function(data){
                              $( ".forum-errors" ).fadeIn( 200 ).delay( 400 ).fadeOut( 300 );
                          }
                       });


                     }
              });

              $('#forumnew-publish').click(function() {

                  if ($('#newforumform').valid()) {
                      
                      var arr = {
                          emotion: $("#feeling").val(),
                          attitude: attitude[$('input[type=radio][name=forumnew_attitude]:checked').val()],
                          subject: $("#subject").val(),
                          user_id: $("#emotion_user_id").val(),
                      };

                      $.ajax({
                          type: "POST",
                          url: "https://lovehate.io/addnewemotion/",
                          data: JSON.stringify(arr),
                          dataType: 'json',
                          contentType: "application/json; charset=utf-8",

                          success: function(data){
                              redirect_main();
                          },
                          error: function(data){
                              $( "div.errors" ).fadeIn( 200 ).delay( 400 ).fadeOut( 300 );
                          }
                      }); // end ajax call
                  }
              });

              $('#password-change').click(function(event) {
                  if($('#changepassword').valid()) {
                      var arr = {
                          oldpassword: $("#oldpassword").val(),
                          newpassword: $("#newpassword").val(),
                          user_id: $("#user_id").val(),
                      };

                      $.ajax({
                          type: "POST",
                          url: "https://lovehate.io/changepassword/",
                          data: JSON.stringify(arr),
                          dataType: 'json',
                          contentType: "application/json; charset=utf-8",

                          success: function(data){
                              $( ".change-success" ).fadeIn(300).delay(1000).fadeOut(300).promise().done(function() {
                                     wait(1000);
                                 
                                     $('#change-password-modal').hide();
                              });
                          },
                          error: function(data){
                              
                              $( ".change-errors" ).fadeIn( 100 ).delay( 1000 ).fadeOut( 300 );
                          }
                      }); // end ajax call

                  } else {
                  }
              });
                 
              $('#user-register').click(function() {
                  var arr = {
                      username: $("#register_username").val(),
                      password: $("#register_password").val(),
  //                    bio: $("#register_bio").val(),
                      email: $("#register_email").val(),
   //                   fullname: $("#register_name").val()                      
                  };
                  if ($('#registration').valid()) {
                      $.ajax({
                          type: "POST",
                          url: "https://lovehate.io/registernew/",
                          data: JSON.stringify(arr),
                          dataType: 'json',
                          contentType: "application/json; charset=utf-8",

                          success: function(data){
                              $( ".registration-success" ).fadeIn(300).delay(1000).fadeOut(300).promise().done(function() {
                                     wait(1000);
                                     redirect_url('/');
                              });
                          },
                          error: function(data){
                              $( ".registration-errors" ).fadeIn( 100 ).delay( 1000 ).fadeOut( 300 );
                          }

                      });
                  }       
              });
              $('#user-resend-activation').click(function() {
                  var arr = {username: $("#username").val()};
                  $.ajax({
                      type: "POST",
                      url: "https://lovehate.io/resendactivationbyuser/",
                      data: JSON.stringify(arr),
                      dataType: 'json',
                      contentType: "application/json; charset=utf-8",
                      success: function(data){
                          $(".resend-success" ).fadeIn( 100 ).delay( 1500 ).fadeOut( 300 );
                          $('#modal-send-activation').delay( 1500 ).hide();
                      },
                      error: function(data){
                          $("#resend-activation-errors").fadeIn( 200 ).delay( 400 ).fadeOut( 300 );
                      }
                  }); // end ajax call
              }); // end on click for user login

              $('#user-login').click(function(event) {
                  
                 if ($('#authenticateform').valid()) {
                  event.preventDefault();
                  var arr = {username: $("#login_username").val(), 
                             password: $("#login_password").val(),
                             from_session: true}; 
                  $.ajax({
                      type: "POST",
                      url: "https://lovehate.io/authenticate-user/",
                      data: "username="+$("#login_username").val()+"&password="+$("#login_password").val(), //JSON.stringify(arr),
                      dataType: 'json',
                     // contentType: "application/json; charset=utf-8",
                      success: function(data){
                            $('#logged-out').html("<a href='https://lovehate.io/signout'>"+data.username+"</a>");
                            $('#modal-login').hide();
                            if (data.code===200) {
                                if (data.not_activated==true) {
                                    $('#modal-login').hide();
                                    $("#modal-send-activation").show();
                                } else {
                                    $('#authenticateform').submit(); 
                                    $('#modal-login').hide();
                                    $("#authenticateform").submit();
                                    $('#logged-out').html("<a href='https://lovehate.io/signout'>"+data.username+"</a>");
                                    $('#modal-login').hide();
                                }
                            }
                      },
                      error: function(data){
                        $( "div.errors" ).fadeIn( 200 ).delay( 400 ).fadeOut( 300 );
                      }
                  });

                 } //end if
                 
                       
              }); // end on click for user login
       }); // end ready


       function redirect_url(url) {
          var redirect = '/'+url;
          window.location.href = redirect;
       }


       function redirect_main() {
          var url = '/';
          window.location.href = url;
       }
        
       function redirect_login(data) {
           $("#authenticateform").submit();
       }

       function auth(username, password) {
            $('#newmessageunauthform').submit();
       }

       function wait(ms){
           var start = new Date().getTime();
           var end = start;
           while(end < start + ms) {
               end = new Date().getTime();
           }
       }

</script>
-->
<script src="/static/js/app.js"></script>

<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-85743813-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->
</html>
